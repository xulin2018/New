<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta charset="utf-8">
    <script src="js/flexible.js"></script>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script src="js/jquery.js"></script>  <!-- jquery,操作页面上html元素 -->
    <script src="js/velocity.js"></script> <!-- 动画库 -->
    <script src="js/velocity.ui.js"></script><!-- 动画库 -->
    <script src="js/shake.js"></script><!-- 摇一摇组件 -->
    <title>光棍节跟谁过</title>
</head>
<body>
	<div class="loading">
		<div class="loading-wrap">
			<canvas id="mycanvas" width="100" height="100"></canvas>
			<div class="pic"></div>
			<div class="loading-text">100%</div>
		</div>
	</div>
	<div class="home">
		
	</div>
	<div class="result">
		
	</div>
<script type="text/javascript">

		var canvas = document.getElementById('mycanvas');
		var context = canvas.getContext('2d') //返回一个用于在画布上绘图的环境
		context.beginPath()//起始一条路径，或重置当前路径
		context.moveTo(50,50);//把路径移动到画布中的指定点，不创建线条
		context.arc(50,50,50,0,2*Math.PI,false);
		context.closePath()//创建从当前点回到起始点的路径
		context.fillStyle='#fff'//属性设置或返回用于填充绘画的颜色、渐变或模式。
		context.fill()//填充当前的路径
	function drawCircle(percent) {


console.log(percent)
		context.beginPath()//起始一条路径，或重置当前路径
		context.moveTo(50,50);//把路径移动到画布中的指定点，不创建线条
		context.arc(50,50,50,0,(2*Math.PI)*percent/100,false);
		context.closePath()//创建从当前点回到起始点的路径
		context.fillStyle='#ffa9ad'//属性设置或返回用于填充绘画的颜色、渐变或模式。
		context.fill()//填充当前的路径
		$('.loading-text').text(percent+'%')
	}
	// drawCircle()

	// 加载一张图片缓存
	// var img = new Image();
	// 	img.src = pics[index];
	// 	img.onload = function(){
	// 		console.log(index);
	// 		index++
	// 	}
	// 加载多张图片
	var pics = ['http://mat1.gtimg.com/yslp/guanggunjie/css/share.png','http://mat1.gtimg.com/yslp/guanggunjie/css/entitle.png','http://mat1.gtimg.com/yslp/guanggunjie/css/hand.png','http://mat1.gtimg.com/yslp/guanggunjie/css/hand_finger.png','http://mat1.gtimg.com/yslp/guanggunjie/css/home_avatar0.png','http://mat1.gtimg.com/yslp/guanggunjie/css/home_avatar1.png','http://mat1.gtimg.com/yslp/guanggunjie/css/home_avatar2.png','http://mat1.gtimg.com/yslp/guanggunjie/css/home_avatar4.png','http://mat1.gtimg.com/yslp/guanggunjie/css/home_avatar5.png','http://mat1.gtimg.com/yslp/guanggunjie/css/home_avatar6.png','http://mat1.gtimg.com/yslp/guanggunjie/css/home_shake_text.png','http://mat1.gtimg.com/yslp/guanggunjie/css/loading.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_answer.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_answer0.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_answer1.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_answer2.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_answer3.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_answer4.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_answer6.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_avatar.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_avatar_bg.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_avatar_bg_1.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_avatar_bg_2.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_avatar0.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_avatar1.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_avatar2.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_avatar3.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_avatar4.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_avatar6.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_btn.png','http://mat1.gtimg.com/yslp/guanggunjie/css/result_title.png','http://mat1.gtimg.com/yslp/guanggunjie/css/shake_tips.png','http://mat1.gtimg.com/yslp/guanggunjie/css/share.jpg','http://mat1.gtimg.com/yslp/guanggunjie/css/share.png','http://mat1.gtimg.com/yslp/guanggunjie/css/subtitle.png','http://mat1.gtimg.com/yslp/guanggunjie/css/title.png','http://mat1.gtimg.com/yslp/guanggunjie/css/yue.png','http://mat1.gtimg.com/yslp/guanggunjie/css/share0.jpg','http://mat1.gtimg.com/yslp/guanggunjie/css/share1.jpg','http://mat1.gtimg.com/yslp/guanggunjie/css/share2.jpg','http://mat1.gtimg.com/yslp/guanggunjie/css/share3.jpg','http://mat1.gtimg.com/yslp/guanggunjie/css/share4.jpg','http://mat1.gtimg.com/yslp/guanggunjie/css/share5.jpg','http://mat1.gtimg.com/yslp/guanggunjie/css/share6.jpg']

	var index = 0;
	var pics_length = pics.length
	for (var i =0; i <pics_length; i++) {
		var img = new Image();
		img.src = pics[i];
		// console.log(i+'iiii')
		// console.log(index+'index');
		//异步之外用i，异步内部用index
		img.onload = function(){//异步
			index++;
			var percent = Math.floor(index/pics_length*100)
			drawCircle(percent)
		}
	}
// console.log(3)
</script>
</body>
</html>